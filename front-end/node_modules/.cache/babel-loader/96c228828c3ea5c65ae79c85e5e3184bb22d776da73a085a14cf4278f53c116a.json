{"ast":null,"code":"import formatReservationDate from \"./format-reservation-date\";\nimport formatReservationTime from \"./format-reservation-time\"; // Corrected import\n\nconst API_BASE_URL = process.env.REACT_APP_API_BASE_URL || \"\";\n\n/**\n * Defines the default headers for these functions to work with `json-server`\n */\nconst headers = new Headers();\nheaders.append(\"Content-Type\", \"application/json\");\nheaders.append(\"Accept\", \"application/json\"); // Added accept header\n\n/**\n * Fetch `json` from the specified URL and handle error status codes and ignore `AbortError`s\n *\n * @param url\n *  the url for the request.\n * @param options\n *  any options for fetch\n * @param onCancel\n *  value to return if fetch call is aborted. Default value is undefined.\n * @returns {Promise<Error|any>}\n *  a promise that resolves to the `json` data or an error.\n *  If the response is not in the 200 - 399 range, the promise is rejected.\n */\nasync function fetchJson(url, options, onCancel) {\n  try {\n    const response = await fetch(url, options);\n    if (response.status === 204) {\n      return null;\n    }\n    const payload = await response.json();\n    if (payload.error) {\n      return Promise.reject({\n        message: payload.error\n      });\n    }\n    return payload.data;\n  } catch (error) {\n    if (error.name !== \"AbortError\") {\n      console.error(error.stack);\n      throw error;\n    }\n    return Promise.resolve(onCancel);\n  }\n}\n\n/**\n * Retrieves all existing reservations.\n * @returns {Promise<[reservation]>}\n *  a promise that resolves to a possibly empty array of reservations saved in the database.\n */\nexport async function listReservations(params, signal) {\n  const url = new URL(`${API_BASE_URL}/reservations`);\n  Object.entries(params).forEach(([key, value]) => url.searchParams.append(key, value.toString()));\n  return await fetchJson(url, {\n    headers,\n    signal\n  }, []).then(formatReservationDate).then(formatReservationTime);\n}\n\n/**\n * Creates a new reservation.\n * @param reservation\n *  the reservation to save.\n * @param signal\n *  optional AbortController.signal\n * @returns {Promise<reservation>}\n *  a promise that resolves to the saved reservation.\n */\nexport async function createReservation(reservation, signal) {\n  const url = `${API_BASE_URL}/reservations`;\n  const options = {\n    method: \"POST\",\n    headers,\n    body: JSON.stringify({\n      data: reservation\n    }),\n    signal\n  };\n  return await fetchJson(url, options);\n}\n\n/**\n * Reads a reservation by ID.\n * @param reservationId\n *  the ID of the reservation to read.\n * @param signal\n *  optional AbortController.signal\n * @returns {Promise<reservation>}\n *  a promise that resolves to the reservation.\n */\nexport async function readReservation(reservationId, signal) {\n  const url = `${API_BASE_URL}/reservations/${reservationId}`;\n  return await fetchJson(url, {\n    headers,\n    signal\n  }, {});\n}\n\n/**\n * Updates an existing reservation.\n * @param reservationId\n *  the ID of the reservation to update.\n * @param reservation\n *  the reservation data to update.\n * @param signal\n *  optional AbortController.signal\n * @returns {Promise<reservation>}\n *  a promise that resolves to the updated reservation.\n */\nexport async function updateReservation(reservationId, reservation, signal) {\n  const url = `${API_BASE_URL}/reservations/${reservationId}`;\n  const options = {\n    method: \"PUT\",\n    headers,\n    body: JSON.stringify({\n      data: reservation\n    }),\n    signal\n  };\n  return await fetchJson(url, options);\n}\n\n/**\n * Cancels a reservation.\n * @param reservationId\n *  the ID of the reservation to cancel.\n * @param signal\n *  optional AbortController.signal\n * @returns {Promise<void>}\n *  a promise that resolves when the reservation is canceled.\n */\nexport async function cancelReservation(reservationId, signal) {\n  const url = `${API_BASE_URL}/reservations/${reservationId}/status`;\n  const options = {\n    method: \"PUT\",\n    headers,\n    body: JSON.stringify({\n      data: {\n        status: \"cancelled\"\n      }\n    }),\n    signal\n  };\n  return await fetchJson(url, options);\n}\n\n/**\n * Lists all tables.\n * @param signal\n *  optional AbortController.signal\n * @returns {Promise<[table]>}\n *  a promise that resolves to a possibly empty array of tables saved in the database.\n */\nexport async function listTables(signal) {\n  const url = `${API_BASE_URL}/tables`;\n  return await fetchJson(url, {\n    headers,\n    signal\n  }, []);\n}\n\n/**\n * Creates a new table.\n * @param table\n *  the table to save.\n * @param signal\n *  optional AbortController.signal\n * @returns {Promise<table>}\n *  a promise that resolves to the saved table.\n */\nexport async function createTable(table, signal) {\n  const url = `${API_BASE_URL}/tables`;\n  const options = {\n    method: \"POST\",\n    headers,\n    body: JSON.stringify({\n      data: table\n    }),\n    signal\n  };\n  return await fetchJson(url, options);\n}\n\n/**\n * Updates a table.\n * @param tableId\n *  the ID of the table to update.\n * @param table\n *  the table data to update.\n * @param signal\n *  optional AbortController.signal\n * @returns {Promise<table>}\n *  a promise that resolves to the updated table.\n */\nexport async function updateTable(tableId, table, signal) {\n  const url = `${API_BASE_URL}/tables/${tableId}`;\n  const options = {\n    method: \"PUT\",\n    headers,\n    body: JSON.stringify({\n      data: table\n    }),\n    signal\n  };\n  return await fetchJson(url, options);\n}\n\n/**\n * Removes a reservation from a table.\n * @param tableId\n *  the ID of the table to remove the reservation from.\n * @param signal\n *  optional AbortController.signal\n * @returns {Promise<void>}\n *  a promise that resolves when the reservation is removed.\n */\nexport async function removeReservation(tableId, signal) {\n  const url = `${API_BASE_URL}/tables/${tableId}/seat`;\n  const options = {\n    method: \"DELETE\",\n    headers,\n    signal\n  };\n  return await fetchJson(url, options);\n}","map":{"version":3,"names":["formatReservationDate","formatReservationTime","API_BASE_URL","process","env","REACT_APP_API_BASE_URL","headers","Headers","append","fetchJson","url","options","onCancel","response","fetch","status","payload","json","error","Promise","reject","message","data","name","console","stack","resolve","listReservations","params","signal","URL","Object","entries","forEach","key","value","searchParams","toString","then","createReservation","reservation","method","body","JSON","stringify","readReservation","reservationId","updateReservation","cancelReservation","listTables","createTable","table","updateTable","tableId","removeReservation"],"sources":["/Users/siangling/starter-restaurant-reservation/front-end/src/utils/api.js"],"sourcesContent":["import formatReservationDate from \"./format-reservation-date\";\nimport formatReservationTime from \"./format-reservation-time\"; // Corrected import\n\nconst API_BASE_URL =\n  process.env.REACT_APP_API_BASE_URL || \"\"\n\n/**\n * Defines the default headers for these functions to work with `json-server`\n */\nconst headers = new Headers();\nheaders.append(\"Content-Type\", \"application/json\");\nheaders.append(\"Accept\", \"application/json\"); // Added accept header\n\n/**\n * Fetch `json` from the specified URL and handle error status codes and ignore `AbortError`s\n *\n * @param url\n *  the url for the request.\n * @param options\n *  any options for fetch\n * @param onCancel\n *  value to return if fetch call is aborted. Default value is undefined.\n * @returns {Promise<Error|any>}\n *  a promise that resolves to the `json` data or an error.\n *  If the response is not in the 200 - 399 range, the promise is rejected.\n */\nasync function fetchJson(url, options, onCancel) {\n  try {\n    const response = await fetch(url, options);\n\n    if (response.status === 204) {\n      return null;\n    }\n\n    const payload = await response.json();\n\n    if (payload.error) {\n      return Promise.reject({ message: payload.error });\n    }\n    return payload.data;\n  } catch (error) {\n    if (error.name !== \"AbortError\") {\n      console.error(error.stack);\n      throw error;\n    }\n    return Promise.resolve(onCancel);\n  }\n}\n\n/**\n * Retrieves all existing reservations.\n * @returns {Promise<[reservation]>}\n *  a promise that resolves to a possibly empty array of reservations saved in the database.\n */\nexport async function listReservations(params, signal) {\n  const url = new URL(`${API_BASE_URL}/reservations`);\n  Object.entries(params).forEach(([key, value]) =>\n    url.searchParams.append(key, value.toString())\n  );\n  return await fetchJson(url, { headers, signal }, [])\n    .then(formatReservationDate)\n    .then(formatReservationTime);\n}\n\n/**\n * Creates a new reservation.\n * @param reservation\n *  the reservation to save.\n * @param signal\n *  optional AbortController.signal\n * @returns {Promise<reservation>}\n *  a promise that resolves to the saved reservation.\n */\nexport async function createReservation(reservation, signal) {\n  const url = `${API_BASE_URL}/reservations`;\n  const options = {\n    method: \"POST\",\n    headers,\n    body: JSON.stringify({ data: reservation }),\n    signal,\n  };\n  return await fetchJson(url, options);\n}\n\n/**\n * Reads a reservation by ID.\n * @param reservationId\n *  the ID of the reservation to read.\n * @param signal\n *  optional AbortController.signal\n * @returns {Promise<reservation>}\n *  a promise that resolves to the reservation.\n */\nexport async function readReservation(reservationId, signal) {\n  const url = `${API_BASE_URL}/reservations/${reservationId}`;\n  return await fetchJson(url, { headers, signal }, {});\n}\n\n/**\n * Updates an existing reservation.\n * @param reservationId\n *  the ID of the reservation to update.\n * @param reservation\n *  the reservation data to update.\n * @param signal\n *  optional AbortController.signal\n * @returns {Promise<reservation>}\n *  a promise that resolves to the updated reservation.\n */\nexport async function updateReservation(reservationId, reservation, signal) {\n  const url = `${API_BASE_URL}/reservations/${reservationId}`;\n  const options = {\n    method: \"PUT\",\n    headers,\n    body: JSON.stringify({ data: reservation }),\n    signal,\n  };\n  return await fetchJson(url, options);\n}\n\n/**\n * Cancels a reservation.\n * @param reservationId\n *  the ID of the reservation to cancel.\n * @param signal\n *  optional AbortController.signal\n * @returns {Promise<void>}\n *  a promise that resolves when the reservation is canceled.\n */\nexport async function cancelReservation(reservationId, signal) {\n  const url = `${API_BASE_URL}/reservations/${reservationId}/status`;\n  const options = {\n    method: \"PUT\",\n    headers,\n    body: JSON.stringify({ data: { status: \"cancelled\" } }),\n    signal,\n  };\n  return await fetchJson(url, options);\n}\n\n/**\n * Lists all tables.\n * @param signal\n *  optional AbortController.signal\n * @returns {Promise<[table]>}\n *  a promise that resolves to a possibly empty array of tables saved in the database.\n */\nexport async function listTables(signal) {\n  const url = `${API_BASE_URL}/tables`;\n  return await fetchJson(url, { headers, signal }, []);\n}\n\n/**\n * Creates a new table.\n * @param table\n *  the table to save.\n * @param signal\n *  optional AbortController.signal\n * @returns {Promise<table>}\n *  a promise that resolves to the saved table.\n */\nexport async function createTable(table, signal) {\n  const url = `${API_BASE_URL}/tables`;\n  const options = {\n    method: \"POST\",\n    headers,\n    body: JSON.stringify({ data: table }),\n    signal,\n  };\n  return await fetchJson(url, options);\n}\n\n/**\n * Updates a table.\n * @param tableId\n *  the ID of the table to update.\n * @param table\n *  the table data to update.\n * @param signal\n *  optional AbortController.signal\n * @returns {Promise<table>}\n *  a promise that resolves to the updated table.\n */\nexport async function updateTable(tableId, table, signal) {\n  const url = `${API_BASE_URL}/tables/${tableId}`;\n  const options = {\n    method: \"PUT\",\n    headers,\n    body: JSON.stringify({ data: table }),\n    signal,\n  };\n  return await fetchJson(url, options);\n}\n\n/**\n * Removes a reservation from a table.\n * @param tableId\n *  the ID of the table to remove the reservation from.\n * @param signal\n *  optional AbortController.signal\n * @returns {Promise<void>}\n *  a promise that resolves when the reservation is removed.\n */\nexport async function removeReservation(tableId, signal) {\n  const url = `${API_BASE_URL}/tables/${tableId}/seat`;\n  const options = {\n    method: \"DELETE\",\n    headers,\n    signal,\n  };\n  return await fetchJson(url, options);\n} "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}